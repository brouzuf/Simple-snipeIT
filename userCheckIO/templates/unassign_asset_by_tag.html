{% extends 'base.html' %}

{% block title %}Unassign Asset from {{ user_context.name|default:user_context.username|default_if_none:"User" }}{% endblock %}

{% block content %}
    <style>
        /* Consider moving to a static CSS file if styles become complex or are reused */
        .form-container { margin-top: 20px; margin-bottom: 20px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9; max-width: 600px; margin-left: auto; margin-right: auto; }
        .form-container h1 { font-size: 1.8em; margin-bottom: 15px; color: #333; }
        .form-container p { margin-bottom: 15px; }
        .form-container .label { font-weight: bold; display: block; margin-bottom: 5px; }
        .form-container .input { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .form-container .button { padding: 10px 20px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1em; }
        .form-container .button:hover { background-color: #c82333; }
        .form-container .help.is-danger { color: #dc3545; font-size: 0.9em; margin-top: -5px; margin-bottom: 10px; }
        .navigation-links { margin-top: 20px; }
        .navigation-links a { margin-right: 15px; color: #007bff; text-decoration: none; }
        .navigation-links a:hover { text-decoration: underline; }
    </style>

    <div class="form-container">
        <h1>Unassign Asset</h1>

        {% if user_context %}
            <p>You are about to unassign an asset. The context for redirection after unassignment is user:
            <strong>{{ user_context.name|default:user_context.username }}</strong> (ID: {{ user_context.id }}).
            Enter the asset tag of the item you wish to check in (unassign).</p>
        {% else %}
            <p>Enter the asset tag of the item you wish to check in (unassign).</p>
        {% endif %}

        <form method="post" action="{% url 'unassign_asset_by_tag' user_id=user_id %}">
            {% csrf_token %}

            {% if form.non_field_errors %}
                <div class="notification is-danger">
                    {% for error in form.non_field_errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            <div class="field">
                <label for="{{ form.asset_tag.id_for_label }}" class="label">{{ form.asset_tag.label }}</label>
                <div class="control">
                    {{ form.asset_tag.as_widget(attrs={'class': 'input', 'placeholder': 'Enter asset tag to unassign'}) }}
                </div>
                {% if form.asset_tag.help_text %}
                    <p class="help">{{ form.asset_tag.help_text }}</p>
                {% endif %}
                {% for error in form.asset_tag.errors %}
                    <p class="help is-danger">{{ error }}</p>
                {% endfor %}
            </div>

            <button type="submit" class="button">Unassign Asset by Tag</button>
        </form>
    </div>

    <div class="navigation-links has-text-centered">
        {% if user_context and user_context.employee_number %}
            <a href="{% url 'user_asset_view' %}?employee_number={{ user_context.employee_number }}">Back to {{ user_context.name|default:user_context.username }}'s Assets</a>
        {% elif user_context %}
             {# If no employee number, maybe a generic link or just to index #}
             <a href="{% url 'index' %}">Back to Search</a>
        {% endif %}
        <a href="{% url 'index' %}">Back to Home/Search</a>
    </div>

{% endblock %}
